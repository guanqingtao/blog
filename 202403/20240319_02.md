## PostgreSQL 17 preview - 增加uuid功能函数: 提取UUID值里面的时间戳 和 生成UUID值的函数版本     
                                                                              
### 作者                                                                              
digoal                                                                              
                                                                              
### 日期                                                                              
2024-03-19                                                                       
                                                                              
### 标签                                                                              
PostgreSQL , PolarDB , DuckDB , uuid , uuid_extract_timestamp , uuid_extract_version                   
                                                                              
----                                                                              
                                                                              
## 背景   
https://git.postgresql.org/gitweb/?p=postgresql.git;a=commit;h=794f10f6b920670cb9750b043a2b2587059d5051  
```  
Add some UUID support functions  
author	Peter Eisentraut <peter@eisentraut.org>	  
Tue, 19 Mar 2024 08:30:24 +0000 (09:30 +0100)  
committer	Peter Eisentraut <peter@eisentraut.org>	  
Tue, 19 Mar 2024 08:32:04 +0000 (09:32 +0100)  
commit	794f10f6b920670cb9750b043a2b2587059d5051  
tree	0615c2dddfc92ebb5d219d87f5c5f84830a4e365	tree  
parent	d56cb42b54381d414f1f30929ca267e4768313c8	commit | diff  
Add some UUID support functions  
  
Add uuid_extract_timestamp() and uuid_extract_version().  
  
Author: Andrey Borodin  
Reviewed-by: Sergey Prokhorenko, Kirk Wolak, Przemysław Sztoch  
Reviewed-by: Nikolay Samokhvalov, Jelte Fennema-Nio, Aleksander Alekseev  
Reviewed-by: Peter Eisentraut, Chris Travers, Lukas Fittl  
Discussion: https://postgr.es/m/CAAhFRxitJv%3DyoGnXUgeLB_O%2BM7J2BJAmb5jqAT9gZ3bij3uLDA%40mail.gmail.com  
```  
  
```  
+  <indexterm>  
+   <primary>uuid_extract_timestamp</primary>  
+  </indexterm>  
+  
+  <indexterm>  
+   <primary>uuid_extract_version</primary>  
+  </indexterm>  
+  
   <para>  
    <productname>PostgreSQL</productname> includes one function to generate a UUID:  
 <synopsis>  
@@ -14141,6 +14149,28 @@ CREATE TYPE rainbow AS ENUM ('red', 'orange', 'yellow', 'green', 'blue', 'purple  
    implement other standard algorithms for generating UUIDs.  
   </para>  
   
+  <para>  
+   There are also functions to extract data from UUIDs:  
+<synopsis>  
+<function>uuid_extract_timestamp</function> (uuid) <returnvalue>timestamp with time zone</returnvalue>  
+</synopsis>  
+   This function extracts a <type>timestamp with time zone</type> from UUID  
+   version 1.  For other versions, this function returns null.  Note that the  
+   extracted timestamp is not necessarily exactly equal to the time the UUID  
+   was generated; this depends on the implementation that generated the UUID.  
+  </para>  
+  
+  <para>  
+<synopsis>  
+<function>uuid_extract_version</function> (uuid) <returnvalue>smallint</returnvalue>  
+</synopsis>  
+   This function extracts the version from a UUID of the variant described by  
+   <ulink url="https://tools.ietf.org/html/rfc4122">RFC 4122</ulink>.  For  
+   other variants, this function returns null.  For example, for a UUID  
+   generated by <function>gen_random_uuid</function>, this function will  
+   return 4.  
+  </para>  
+  
```  
  
```  
+-- extract functions  
+-- version  
+SELECT uuid_extract_version('11111111-1111-5111-8111-111111111111');  -- 5  
+ uuid_extract_version   
+----------------------  
+                    5  
+(1 row)  
+  
+SELECT uuid_extract_version(gen_random_uuid());  -- 4  
+ uuid_extract_version   
+----------------------  
+                    4  
+(1 row)  
+  
+SELECT uuid_extract_version('11111111-1111-1111-1111-111111111111');  -- null  
+ uuid_extract_version   
+----------------------  
+                       
+(1 row)  
+  
+-- timestamp  
+SELECT uuid_extract_timestamp('C232AB00-9414-11EC-B3C8-9F6BDECED846') = 'Tuesday, February 22, 2022 2:22:22.00 PM GMT+05:00';  -- RFC 4122bis test vector  
+ ?column?   
+----------  
+ t  
+(1 row)  
+  
+SELECT uuid_extract_timestamp(gen_random_uuid());  -- null  
+ uuid_extract_timestamp   
+------------------------  
+   
+(1 row)  
+  
+SELECT uuid_extract_timestamp('11111111-1111-1111-1111-111111111111');  -- null  
+ uuid_extract_timestamp   
+------------------------  
+   
+(1 row)  
```  
    
  
#### [期望 PostgreSQL|开源PolarDB 增加什么功能?](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
  
  
#### [PolarDB 开源数据库](https://openpolardb.com/home "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PolarDB 学习图谱](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [购买PolarDB云服务折扣活动进行中, 55元起](https://www.aliyun.com/activity/new/polardb-yunparter?userCode=bsb3t4al "e0495c413bedacabb75ff1e880be465a")
  
  
#### [PostgreSQL 解决方案集合](../201706/20170601_02.md "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [德哥 / digoal's Github - 公益是一辈子的事.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
#### [About 德哥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
