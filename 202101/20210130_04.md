## 数据库 或 成为SaaS aPaaS|低代码|无代码 革命 绊脚石 - aPaaS 需要什么样的数据库?  
        
### 作者        
digoal        
        
### 日期        
2021-01-30        
        
### 标签        
PostgreSQL , 低代码 , 无代码 , aPaaS , 多租户 , 多模 , 弹性 , 宽表 , 隔离 , 高并发          
        
----        
        
## 背景        
## 什么是SaaS  
SaaS即Software-as-a-Service（软件即服务）是随着互联网技术的发展和应用软件的成熟， 在21世纪开始兴起的一种完全创新的软件应用模式。传统模式下，厂商通过License将软件产品部署到企业内部多个客户终端实现交付。SaaS定义了一种新的交付方式，也使得软件进一步回归服务本质。企业部署信息化软件的本质是为了自身的运营管理服务，软件的表象是一种业务流程的信息化，本质还是第一种服务模式，SaaS改变了传统软件服务的提供方式，减少本地部署所需的大量前期投入，进一步突出信息化软件的服务属性，或成为未来信息化软件市场的主流交付模式。  
  
### SaaS对企业客户的价值  
- 传统软件部署的方式版本迭代慢, 使用SaaS可以享受更快的功能迭代,   
- 初期软件费用相比购买License更少,   
- SaaS运行在远端, 客户不需要投入运行软件的硬件.   
- 企业采取SaaS租用的方式，不需要专门的维护和管理人员，也不需要为维护和管理人员支付额外费用。  
- 用户采用传统软件部署, 需要额外购买数据库软件, 使用SaaS后, 不需要购买数据库软件. 整体费用大幅度降低.   
  
### SaaS对厂商的价值  
- 客户的长期价值更大.   
- 集中化部署, 销售和售后成本降低.  
  
## 什么是aPaaS  
SaaS是通用的软件平台, 而aPaaS简单来说, 就是为了解决企业的定制化需求, 解决SaaS厂商和客户之间供需不平衡的问题.    
  
可以参考Salesforce发展的4个阶段:  
  
1、1999-2004 SaaS理念先驱  
其创始人马克·贝尼奥夫(Marc Benioff)在创办Salesforce之前已经是软件业的 资深从业者，对于传统软件模式的弊端深有感触。其在90年代末互联网思潮涌动 的年代开始对Oracle一次性收取高昂费用的软件售卖模式产生反思，逐渐萌生软 件即服务(SaaS)的想法。  
当时云计算的基础设施建设还不足，IaaS龙头亚马逊云要到6年后才开展业务， 因此Salesforce以自建数据中心的方式来解决市场中IaaS层的缺失问题。  
Salesforce于2000年推出了销售自动化(SFA)产品，2001年推出第一款SaaS CRM产品。2004年，Salesforce上市，成为了一家市值10亿美元左右的上市公 司，股票代码CRM。  
  
2、2005-2009 做aPaaS技术架构,建立SaaS生态  
随着SaaS理念开始普及，Salesforce逐渐感觉到来自追赶者的压力，同时也意识 到和传统软件巨头竞争的乏力。  
前后夹击下，Salesforce开始转型。面向第三方开发者的AppExchange在2005 年推出，第三方SaaS应用的开发者可以将自己开发的SaaS产品在这个平台上发 布，供他人订阅。但这个产品在2005年只能称为是一个SaaS开发者的交流社区 而已，Salesforce此时的底层技术能力还很弱，不足以称之为统一架构下的生态。  
2006年，Salesforce推出基于云平台的开发语言Apex，供开发者在Salesforce 的共享平台上开发SaaS应用。  
2007年，Salesforce终于推出了世界上第一个可以在统一架构上部署应用的 PaaS平台——Force.com，又创造了一个理念——平台即服务。  
Gartner将PaaS分为集成平台IPaaS层(integration platform as a service)和 应用部署和运行平台APaaS层(application platform as a service)。Gartner 对APaaS的定义是，“基于PaaS(平台即服务)的一种解决方案，支持应用程 序在云端的开发、部署和运行，提供软件开发中的基础工具给用户，包括数据对 象、权限管理、用户界面等。” Force.com的定位属于后者。可以将其理解为一 整套直接服务于SaaS开发的底层架构。  
  
在APaaS模式下，非技术人员可以直接在云端完成应用程序的搭建、部署、使用、 更新和管理。APaaS平台的建立对于Salesforce的意义在于，永久地拉开了和后 续进入SaaS市场竞争者的关系，同时补足了和传统软件大厂竞争的短板。  
对于后续进入SaaS市场的竞争者而言，Salesforce提供的APaaS平台提供了快速 开发的条件，开发者在几个小时内就能完成应用的开发、测试、部署，并能够随 时调整或更新，同时这种开发对编程能力的要求降低，可以使得开发者更关心具 体业务的实现。SaaS层面的竞争开始变得不再是IT技术的竞争，而是对企业业务 需求捕捉、理解和实现解决优化能力的考验。Salesforce通过升维思考实现了对 SaaS厂商的降维打击，捍卫了自己的行业地位。  
PaaS层在技术上补足了数据管理和API接口、用户界面和SaaS整合、权限管理和 二次开发等方面的短板，使得Salesforce在和传统软件巨头竞争过程中具有了技 术能力。  
  
3、2009-2015 基于平台云的能力整合，围绕CRM的业务拓展  
这段时间是Salesforce基于平台云能力进行能力圈扩展的过程，并购与整合是这 段时期的主题。  
IT领域的研发过程较长，因此并购整合是企业快速拓展某方面能力的最佳方式， 因此我们也看到在IT领域美国企业的并购频繁。Salesforce迅速的并购并整合， 扩充围绕着CRM展开的各方面企业服务，包括销售服务、营销服务和客户服务。 Data.com、Desk.com和Social.com，这三个顶级域名及背后产品所带来组合的 价值超乎想象，形成了后来客服云、营销云和电商云的雏形。  
面对移动化浪潮，Salesforce以极为快速的反应于2013年推出Salesforce1平台， 将各业务移动化，从此Web端的服务可以在移动端实现，大大拓展了产品使用场景。  
经历了长达6年的产品整合和升级后，Salesforce拥有了一站式服务营销、销售和 客服的能力，同时具备了移动化和社交化的能力。  
  
4、2015至今 大数据和人工智能时代的产品智能化改造  
2015年至今，Salesforce始终在利用技术上的进步精细化改造自己的产品，主要 围绕人工智能和数据智能这两个角度展开。  
2015年以来展开的一系列人工智能领域的并购，使得Salesforce有能力在2016 年DreamForce大会上推出人工智能平台Einstein(爱因斯坦)，进而将AI能力 贯穿于SaaS层云服务中。Einstein主要采用自然语言处理和图像识别技术，结合 数据挖掘的技术实现商业信息的自动发掘，客户行为的预测和自主行动决策，提 升营销、销售和客户服务能力。  
数据智能方面，Krux、Mulesoft和Tableau这几家公司从多源数据整合和数据分 析的角度分别贡献了能力，使得Salesforce有能力将数据智能方案输出给客户。  
在这个阶段，Salesforce的并购总金额依旧很高，但可以看出其并购路线更关注 于大数据和人工智能的技术路线，而非2009-2015年阶段的产品路线。  
Salesforce进入到利用先进数据技术对产品的精细化打磨期，将先进技术融入到 产品中。  
  
## 中国SaaS起步较晚, 直接进入低代码阶段, 来势汹汹  
https://mp.weixin.qq.com/s/fhi4la0QXT6Dt18X01839w  
  
2021中国低/无代码平台投融资趋势报告： 融资规模近15亿，估值近70亿，马太效应将愈演愈烈  
  
2018年6月，成立16年、专注低代码开发平台12年的OutSystems一举获得来自KKR和高盛的3.6亿美元投资。Outsystems因此成功挤进10亿美元俱乐部，成为新晋独角兽。  
  
OutSystems在低代码界激起的水花被同期接力到了国内的资本市场。国内市场相关融资消息也频频发生：  
  
2018年5月，低代码软件开发平台搭搭云获千万级人民币A轮融资；  
  
2019年上半年，PaaS平台研发商ClickPaaS获晨兴资本数百万美元A轮融资；  
  
2018年5月和2019年3月，低代码数字化平台服务商奥哲先后获得阿里5千万人民币A+轮融资和高榕资本上亿元B轮融资；  
  
2018-2020年，究竟多少家低代码平台获得融资？什么类型的低代码平台更容易受资本青睐？已经入局这个市场的BAT投资策略究竟有何不同？未来的融资又将呈现出怎样的趋势？  
  
## 数据库挑战  
- 钱  
- 上万企业使用, 每个企业一套数据集, 需要数据库的管理便捷性  
- erp,crm,hrm,im,oa,发票,财务等系统的业务逻辑都非常复杂, 数据模型也非常复杂, 使用的数据库几乎都是oracle, sql server, 对数据库的数据处理能力要求非常高  
- 越来越多多模的数据类型出现, 同时需要对其进行处理  
- 敏捷开发, 变化快(数据结构, 索引加减, SQL变幻莫测, 索引自动推荐)  
- 每个租户一套数据模型, 需要多租户和资源隔离, 弹性能力  
- 数据处理能力需求(并行计算)  
- 随随便便就上百个表的JOIN性能  
  
  
## PG解法  
### 1、无法律风险  
  
不论是你来分发, 还是用户自己安装, 都没有法律风险.   
  
### 2、免费  
  
不要钱很重要  
  
### 3、多租户  
  
schema/database 级别多租户  
  
### 4、多模  
  
json|xml|hstore|cube schemaless支持  
图式查询支持  
文本搜索(支持实时索引, 前后百分号模糊搜索, 分词, 相似搜索等)  
内置机器学习库madlib  
GIS地理信息数据类型和索引(PostGIS)  
拓扑索引(pgrouting)  
相似推荐搜索索引(pase,imgsmlr,smlar)  
标签索引(roaringbitmap, array, gin)  
多维数据模型(cube)  
行列变换  
时序索引(brin)  
时序表(timescaledb)  
定时任务(pg_cron)  
异步消息  
流订阅  
10余种索引(btree,hash,gin,gist,spgist,brin,bloom,rum,pase(阿里云),zombodb)  
  
### 5、大量国产数据库都基于PG  
  
华为opengauss  
阿里polardb pg-o  
腾讯tbase, cynosdb  
亚信antdb  
中兴goldendb  
阿里云adb pg
  
### 6、可扩展插件, 打出垂直行业技术壁垒  
  
不需要修改内核, 通过API能支持数据库的功能扩展, 在数据库中支持行业特性, 例如:  
rdkit, 医疗、化学行业, 化学分子式计算  
pase, 人脸识别计算  
madlib, 机器学习  
postgis, 地理信息,卫星影像,地图,激光点云等处理  
roaringbitmap, 电商行业,相似标签推荐  
timescaledb, IoT行业时序数据处理  
  
同时开源提供了很多插件可直接使用.  
https://pgxn.org/  
  
### 7、横向扩展  
  
Citus, 可以横向扩展到PB级别  
  
### 8、平滑加减字段, 修改字段长度  
  
低代码下, 数据模型的要求是最灵活的, 匹配用户定制化的功能模块, 加减字段, 修改字段一定很频繁.  
PG支持平滑加减,修改字段长度(大量不需要rewrite)  
  
### 9、在线加索引  
  
低代码下, 数据模型的要求是最灵活的, 匹配用户定制化的功能模块, 平滑加索引很重要.   
如果加个索引要锁表, 是不是要疯掉,根本无法满足敏捷要求.  
  
### 10、自动推荐索引  
  
低代码下, 数据模型的要求是最灵活的, 匹配用户定制化的功能模块, ORM提供的SQL变化无穷, 支持自动推荐索引, 大量简化SaaS厂商优化工作量.  
  
### 11、在线垃圾回收  
  
不堵塞用户操作.  
  
### 12、优化器, 高级优化器  
  
低代码下, 数据模型的要求是最灵活的, 匹配用户定制化的功能模块, ORM提供的SQL变化无穷, 复杂SQL能不能优化好, 是很重要的能力.  
支持数百种数据访问方法, 支持CBO和遗传算法(超多表JOIN优化), 支持扩展aqo(基于机器学习的超多表JOIN动态优化)  
  
### 13、并行计算  
  
跑个报表是多么低的要求啊, 但是怎么才能快, 天下武功唯快不破.  
PG支持几乎任何SQL, 任何NODE都能用多CPU并行.  
10亿数据量,聚合只需要2秒.   
[《PostgreSQL 并行计算解说 汇总》](../201903/20190318_05.md)    
  
### 14、稳如泰山  
  
PG 的稳定性是产业界出了名的, 稳如狗.   
  
### 15、功能和Oracle一个级别, 在垂直领域甚至超过Oracle  
  
例如odoo是全球最流行的开源SaaS软件, 指定使用PostgreSQL数据库.    
  
## PostgreSQL 数据库是 aPaaS 的最佳选择
  
  
  
  
#### [PostgreSQL 许愿链接](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216")
您的愿望将传达给PG kernel hacker、数据库厂商等, 帮助提高数据库产品质量和功能, 说不定下一个PG版本就有您提出的功能点. 针对非常好的提议，奖励限量版PG文化衫、纪念品、贴纸、PG热门书籍等，奖品丰富，快来许愿。[开不开森](https://github.com/digoal/blog/issues/76 "269ac3d1c492e938c0191101c7238216").  
  
  
#### [9.9元购买3个月阿里云RDS PostgreSQL实例](https://www.aliyun.com/database/postgresqlactivity "57258f76c37864c6e6d23383d05714ea")
  
  
#### [PostgreSQL 解决方案集合](https://yq.aliyun.com/topic/118 "40cff096e9ed7122c512b35d8561d9c8")
  
  
#### [德哥 / digoal's github - 公益是一辈子的事.](https://github.com/digoal/blog/blob/master/README.md "22709685feb7cab07d30f30387f0a9ae")
  
  
![digoal's wechat](../pic/digoal_weixin.jpg "f7ad92eeba24523fd47a6e1a0e691b59")
  
  
#### [PolarDB 学习图谱: 训练营、培训认证、在线互动实验、解决方案、生态合作、写心得拿奖品](https://www.aliyun.com/database/openpolardb/activity "8642f60e04ed0c814bf9cb9677976bd4")
  
  
#### [购买PolarDB云服务折扣活动进行中, 55元起](https://www.aliyun.com/activity/new/polardb-yunparter?userCode=bsb3t4al "e0495c413bedacabb75ff1e880be465a")
  
  
#### [About 德哥](https://github.com/digoal/blog/blob/master/me/readme.md "a37735981e7704886ffd590565582dd0")
  
